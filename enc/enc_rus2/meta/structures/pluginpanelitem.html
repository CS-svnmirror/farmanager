<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>PluginPanelItem</title>
<meta http-equiv="Content-Type" Content="text/html; charset=Windows-1251">
<link rel="stylesheet" type="text/css" href="../../styles/styles.css">
<script language="javascript" src='../links.js' type="text/javascript"></script>
</head>
<body>

<h1>PluginPanelItem</h1>
<div class=navbar>
<a href="../index.html">главная</a> |
<a  href="index.html">структуры</a><br>
</div>

<div class=shortdescr>
Структура <dfn>PluginPanelItem</dfn> описывает элемент файловой системы в файловой системе
эмулируемой плагином. Она используется для возвращения информации о файловой системе плагина и
для передачи плагину списка файлов для обработки.
</div>

<pre class=syntax>
struct PluginPanelItem
{
  struct FAR_FIND_DATA FindData;
  DWORD Flags;
  DWORD NumberOfLinks;
  const wchar_t *Description;
  const wchar_t *Owner;
  const wchar_t * const *CustomColumnData;
  int CustomColumnNumber;
  DWORD_PTR UserData;
  DWORD CRC32;
  DWORD_PTR Reserved[2];
};
</pre>
<h3>Элементы</h3>
<div class=descr>
  <div class=dfn>FindData</div>
  <div class=dfndescr>Структура FindData содержит много файловых
    параметров. См. описание структуры <a href="../structures/far_find_data.html">FAR_FIND_DATA</a>
    для более подробной информации.</div>
   <div class=dfn>Flags</div>
  <div class=dfndescr>Может быть комбинацией следующих значений (перечисление <a name="PLUGINPANELITEMFLAGS">PLUGINPANELITEMFLAGS</a>):
    <table class="cont">
    <tr class="cont"><th class="cont" width="40%">Флаг</th><th class="cont" width="60%">Описание</th></tr>
      <tr class="cont"><td class="cont" width="40%"><a name="PPIF_PROCESSDESCR">PPIF_PROCESSDESCR</a></td>
      <td class="cont" width="60%">Использовать внутреннюю обработку описаний FAR'а.<br>
        Этот флаг может быть установлен для обрабатываемых файлов в
        функциях  <a href="../exported_functions/deletefilesw.html">DeleteFilesW</a>,
        <a href="../exported_functions/getfilesw.html">GetFilesW</a> и
        <a href="../exported_functions/putfilesw.html">PutFilesW</a>.
        В этом случае FAR будет обновлять файлы описаний с именами,
        возвращёнными в функции <a href="../exported_functions/getopenplugininfow.html">GetOpenPluginInfoW</a>.
      </td></tr>

      <tr class="cont"><td class="cont" width="40%"><a name="PPIF_SELECTED">PPIF_SELECTED</a></td>
      <td class="cont" width="60%">Этот флаг отвечает за выделение элемента.<br>
      <!-- Для <a href="../service_functions/control.html">Control</a>, в функциях FCTL_GETPANELINFO, FCTL_GETANOTHERPANELINFO, FCTL_SETSELECTION и FCTL_SETANOTHERSELECTION
           этот флаг позволяет проверить и установить выделение элементов. -->
        В функциях <a href="../exported_functions/putfilesw.html">PutFilesW</a>, <a href="../exported_functions/getfilesw.html">GetFilesW</a>
        и <a href="../exported_functions/processhostfilew.html">ProcessHostFileW</a>, если операция не удалась,
        но часть файлов была успешно обработана, плагин может убрать выделение только с обработанных файлов.<br>
        Для этого плагин должен очистить флаг PPIF_SELECTED у обрабатываемых элементов в переданном функции списке <i>PluginPanelItem</i>.
      </td></tr>

      <tr class="cont"><td class="cont" width="40%"><a name="PPIF_USERDATA">PPIF_USERDATA</a></td>
      <td class="cont" width="60%">Если этот флаг установлен, FAR считает поле <i>UserData</i> указателем на структуру пользовательских данных.
        Читайте описание <i>UserData</i> для уточнения информации.
        <p>Младшее слово параметра Flags может быть использовано плагином для своих собственных флагов.
      </td></tr>
      </table>
  </div>

  <div class=dfn>NumberOfLinks</div>
  <div class=dfndescr>Количество жёстких ссылок.</div>
  <div class=dfn>Description</div>
  <div class=dfndescr>Указывает на описание файла. Плагин может использовать это поле для передачи описания файла
    FAR'у. Если вы не хотите указывать описания, установите <i>Description</i> в NULL. Если плагин
    использует стандартную обработку описаний FAR'а, и передал имена описаний FAR'у в функции <a href="../exported_functions/getopenplugininfow.html">GetOpenPluginInfoW</a>, это поле также должно быть NULL.</div>
  <div class=dfn>Owner</div>
  <div class=dfndescr>Указывает на имя владельца файла. Плагин может использовать это поле для передачи имён владельцев файлов FAR'у.
    Если Вам это не нужно, установите это поле в NULL.</div>
  <div class=dfn>CustomColumnData</div>
  <div class=dfndescr>Указывает на массив адресов строк для определённых плагином типов колонок. Первая строка содержит
    данные для типа колонки C0, вторая - для C1 и т.д. Может быть задано до 10 дополнительных типов колонок от <b><code>C0</code></b>
    до <b><code>C9</code></b>. Если вы не нуждаетесь в дополнительных типах колонок, установите
    это поле в NULL.</div>
  <div class=dfn>CustomColumnNumber</div>
  <div class=dfndescr>Число строк с данными о дополнительных типах колонок.</div>
  <div class=dfn>UserData</div>
  <div class=dfndescr>Это поле может быть использовано плагином для хранения 32-битного значения или указателя на структуру данных.
    В последнем случае, когда <i>UserData</i> указывает на структуру данных, первое поле
    этой структуры должно быть 32-битным значением, равным размеру структуры, и плагин должен установить флаг PPIF_USERDATA в
    поле <i>Flags</i>. Это позволит FAR'у правильно скопировать структуру во внутренний буфер FAR'а
    и позже передать её плагину в списках <i>PluginPanelItem</i>. В функции <a href="../exported_functions/freefinddataw.html">FreeFindDataW</a> плагин должен освободить память,
    занятую такими дополнительными структурами.</div>
  <div class=dfn>CRC32</div>
  <div class=dfndescr>Контрольная сумма. FAR не использует это поле. Если плагин использует это поле, необходимо выставить флаг <a href="openplugininfo.html">OPIF_USECRC32</a>.</div>
  <div class=dfn>Reserved</div>
  <div class=dfndescr>Зарезервировано для будущего использования. Установите в 0.</div>
</div>

<h3>Замечания</h3>
<div class=descr>
<ol>
<li>Все данные, выделенные плагином для членов <var>Description</var>,
  <var>Owner</var> и <var>CustomColumnData</var>, должны быть освобождены им.
  FAR создаёт копии этих данные в своих внутренних структурах. Таким образом
  они могут быть освобождены в любой момент после передачи FAR'у в
  функции <a href="../exported_functions/getfinddataw.html">GetFindDataW</a>.

<li>Если плагин использует, например, <var>UserData</var> для получения данных о
   файле, то плагинописатель должен удостовериться в валидности этих
   данных. Это связано с тем, что при вызове <a href="../exported_functions/getfilesw.html">GetFilesW</a>
   из списка найденных файлов  FAR передаёт плагину элементы  <dfn>PluginPanelItem</dfn>
   только с одним правильно заполненным членом - <var>FindData</var>, остальные
   члены установлены в <code>NULL</code>.

</ol>
</div>

<div class=see>Смотрите также:</div><div class=seecont>
<a href="index.html">структуры</a> |
<a href="../structures/far_find_data.html">FAR_FIND_DATA</a>
</div>


</body>
</html>
