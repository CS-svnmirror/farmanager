<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>

<head>
<title>Functions - Macros</title>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
<link rel="stylesheet" type="text/css" href="../../../styles/styles.css">
</head>

<body>

<h1>Functions</h1>
<div class="navbar">
<a href="../../index.html">main</a> |
<a href="../index.html">Macros</a> |
<a href="index.html">Macro-language</a>
</div>

<h3>Function list</h3>
<p>You can use the following functions in the macro sequence:</p>
<table class="cont">
  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Mathematical functions</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Function</th>
    <th class="cont" width="60%">Description</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="abs">abs</a></dfn>(N)</td>
    <td class="cont" width="60%">Returns the absolute value of a numeric argument <em>N</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="max">max</a></dfn>(N1,N2)</td>
    <td class="cont" width="60%">Returns the maximal value of two numeric arguments <em>N1</em> and <em>N2</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="min">min</a></dfn>(N1,N2)</td>
    <td class="cont" width="60%">Returns the minimal value of two numeric arguments <em>N1</em> and <em>N2</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="mod">mod</a></dfn>(N1,N2)</td>
    <td class="cont" width="60%">Division of <em>N1</em> by the modulus <em>N2</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="int">int</a></dfn>(V)</td>
    <td class="cont" width="60%">Evaluates the <em>V</em> argument to a number.</td>
  </tr>

  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>String functions</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Function</th>
    <th class="cont" width="60%">Description</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="index">index</a></dfn>(S1,S2)</td>
    <td class="cont" width="60%">Returns the position of the first occurrence of the substring
    <em>S2</em> within string <em>S1</em>, -1 otherwise.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="rindex">rindex</a></dfn>(S1,S2)</td>
    <td class="cont" width="60%">Returns the position of the last occurrence of the substring
    <em>S2</em> within string <em>S1</em>, -1 otherwise.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">Result=<dfn><a name="replace">replace</a></dfn>(Str,Find,Replace[,Cnt])</td>
    <td class="cont" width="60%">Replace substing <em>Find</em> in <em>Str</em> with <em>Replace</em>, <em>Cnt</em> times
      (set <em>Cnt</em> to 0 or omit this parameter to replace all occurrences).<br>
      Returns the resulting string.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="asc">asc</a></dfn>(S)</td>
    <td class="cont" width="60%">Returns the code of character <em>S</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="chr">chr</a></dfn>(N)</td>
    <td class="cont" width="60%">Returns the character for the code <em>N</em>.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="itoa">itoa</a></dfn>(N[,Radix])</td>
    <td class="cont" width="60%">Converts numeric value <em>N</em> to a string. Parameter
    <em>Radix</em> defines the base of the numerical representation for the number
    conversion. The <em>Radix</em> parameter can be from 2 to 36.
    If <em>Radix</em> is omitted, base 10 is implied.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="atoi">atoi</a></dfn>(S[,Radix])</td>
    <td class="cont" width="60%"> онвертирует строковое представление строки <em>N</em> в число.
    «начение <em>Radix</em> определ€ет базу, котора€ будет использоватьс€ при
    преобразовании строки <em>S</em>. ƒопустимые значени€ <em>Radix</em> от 2 до 36.<br>
    ≈сли параметр <em>Radix</em> не указан, то функци€ попытаетс€ сама определить в каком виде представлено строковое представление числа.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="len">len</a></dfn>(V)</td>
    <td class="cont" width="60%">Returns the length of the expression <em>V</em>.
    This function evaluates the value of <em>V</em> to a string and then returns
    the length of the string.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="string">string</a></dfn>(V)</td>
    <td class="cont" width="60%">Converts the value of the expression <em>V</em> to a string.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="substr">substr</a></dfn>(V,N1[,N2])</td>
    <td class="cont" width="60%">Returns the substring of the expression <em>V</em>
    beginning from position <em>N1</em> with the length of <em>N2</em>.<br>
      ≈сли параметр <em>N2</em> не указан или равен -1, то вернетс€ подстрока от позиции <em>N1</em> до конца строки.<br>
      ≈сли параметр <em>N2</em> равен 0, то вернетс€ пуста€ строка.<br>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="trim">trim</a></dfn>(V[,N])</td>
    <td class="cont" width="60%">”дал€ет все пробельные символы (пробелы, табул€ции,
      переводы строк и возвраты каретки) из строки <em>V</em> снаружи (<em>N</em>=0 или не указан), слева (<em>N</em>=1) или справа (<em>N</em>=2).
      </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="lcase">lcase</a></dfn>(S)</td>
    <td class="cont" width="60%">Transforms the string <em>S</em> to lower-case.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="ucase">ucase</a></dfn>(S)</td>
    <td class="cont" width="60%">Transforms the string <em>S</em> to upper-case .</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="date">date</a></dfn>(format)</td>
    <td class="cont" width="60%">Returns the current date/time according to the format <em>format</em>
    (See the $Date for the <em>format</em> description).<br>
    This function is similar to $Date macro-command but can also be used in expressions.
  The <em>format</em> argument is mandatory.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="xlat">xlat</a></dfn>(S)</td>
    <td class="cont" width="60%">Returns the transliterated string.<br>
    This function is similar to $XLat macro command but can be used in expressions.
    Argument <em>S</em> is mandatory.</td>
  </tr>

  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>File functions</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Function</th>
    <th class="cont" width="60%">Description</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="fsplit">fsplit</a></dfn>(path,N)</td>
    <td class="cont" width="60%">Splits the path <em>path</em> into the components and
    returns theirs combination depending on the flag combination <em>N</em>:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Value</th><th class="cont" width="90%">Description</th></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000001</td><td class="cont" width="90%">Current drive in "C:" representation.<br>For network shares - "\\server\share"</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000002</td><td class="cont" width="90%">Rooted path in "\Program Files\Far\" representation</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000004</td><td class="cont" width="90%">Name</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000008</td><td class="cont" width="90%">Extension in ".EXT" representation or empty string, if there's no extension.</td></tr>
       </table>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="fexist">fexist</a></dfn>(S)</td>
    <td class="cont" width="60%">Checks if the file or folder <em>S</em> exists and returns
      1 if true or 0 otherwise.<br>
      Usage of the '*' and '?' mask symbols is allowed in the <em>S</em> argument. In that case the function
      checks only the first occurrence of the file or folder.<br>
      This function does not work with the panels.
     </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="fattr">fattr</a></dfn>(S)</td>
    <td class="cont" width="60%">Returns the file system attributes of the file or folder <em>S</em>
       <table class="cont">
        <tr class="cont"><th class="cont" width="10%">Attribute</th><th class="cont" width="90%">Description</th></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000001</td><td class="cont" width="90%">FILE_ATTRIBUTE_READONLY. The file or folder is read-only. Applications can read the file but cannot write to it or delete it. In the case of a folder, applications cannot delete it.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000002</td><td class="cont" width="90%">FILE_ATTRIBUTE_HIDDEN. The file or folder is hidden. It is not included in an ordinary directory listing.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000004</td><td class="cont" width="90%">FILE_ATTRIBUTE_SYSTEM. The file or folder is part of the operating system or is used exclusively by the operating system.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000010</td><td class="cont" width="90%">FILE_ATTRIBUTE_DIRECTORY. This is a folder.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000020</td><td class="cont" width="90%">FILE_ATTRIBUTE_ARCHIVE. The file or folder is an archive file. Applications use this attribute to mark files for backup or removal.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000080</td><td class="cont" width="90%">FILE_ATTRIBUTE_NORMAL. The file or folder has no other attributes set. This attribute is valid only if used alone.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000100</td><td class="cont" width="90%">FILE_ATTRIBUTE_TEMPORARY. The file is being used for temporary storage. File systems avoid writing data back to mass storage if sufficient cache memory is available, because often the application deletes the temporary file shortly after the handle is closed. In that case, the system can entirely avoid writing the data. Otherwise, the data will be written after the handle is closed.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000200</td><td class="cont" width="90%">FILE_ATTRIBUTE_SPARSE_FILE. The file is a sparse file.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000400</td><td class="cont" width="90%">FILE_ATTRIBUTE_REPARSE_POINT. The file or folder has an associated reparse point.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000800</td><td class="cont" width="90%">FILE_ATTRIBUTE_COMPRESSED. The file or folder is compressed. For a file, this means that all of the data in the file is compressed. For a folder, this means that compression is the default for newly created files and subdirectories.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00001000</td><td class="cont" width="90%">FILE_ATTRIBUTE_OFFLINE. The data of the file is not immediately available. This attribute indicates that the file data has been physically moved to offline storage. This attribute is used by Remote Storage, the hierarchical storage management software. Applications should not arbitrarily change this attribute.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00002000</td><td class="cont" width="90%">FILE_ATTRIBUTE_NOT_CONTENT_INDEXED. The file or directory is not be indexed by the content indexing service.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00004000</td><td class="cont" width="90%">FILE_ATTRIBUTE_ENCRYPTED. The file or folder is encrypted. For a file, this means that all data in the file is encrypted. For a folder, this means that encryption is the default for newly created files and subdirectories.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00010000</td><td class="cont" width="90%">FILE_ATTRIBUTE_VIRTUAL. A file is a virtual file.</td></tr>
       </table>
       if file system object does not exist this function returns -1.<br>
       Usage of the '*' and '?' mask symbols is allowed in the <em>S</em> argument. In that case the function
       checks only the first occurrence of the file or folder.<br>
       This function does not work with the panels.
    </td>
  </tr>

  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Panel</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Function</th>
    <th class="cont" width="60%">Description</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="panel.fexist">panel.fexist</a></dfn>(panelType,S)</td>
    <td class="cont" width="60%">Checks if the file or folder <em>S</em> exists in the active (<em>panelType</em>=0) or the passive (<em>panelType</em>=1) panel (returns 1 if true or 0 otherwise).<br>
      Usage of the '*' and '?' mask symbols is allowed in the <em>S</em> argument. In that case the function
      checks only the first occurrence of the file or folder.<br>
      This function works only with the panels.
     </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="panel.fattr">panel.fattr</a></dfn>(panelType,S)</td>
    <td class="cont" width="60%">Returns the file system attributes of the file or folder <em>S</em> from the active (<em>panelType</em>=0) or the passive (<em>panelType</em>=1) panel.<br>
       <table class="cont">
        <tr class="cont"><th class="cont" width="10%">Attribute</th><th class="cont" width="90%">Description</th></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000001</td><td class="cont" width="90%">FILE_ATTRIBUTE_READONLY. The file or folder is read-only. Applications can read the file but cannot write to it or delete it. In the case of a folder, applications cannot delete it.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000002</td><td class="cont" width="90%">FILE_ATTRIBUTE_HIDDEN. The file or folder is hidden. It is not included in an ordinary directory listing.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000004</td><td class="cont" width="90%">FILE_ATTRIBUTE_SYSTEM. The file or folder is part of the operating system or is used exclusively by the operating system.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000010</td><td class="cont" width="90%">FILE_ATTRIBUTE_DIRECTORY. This is a folder.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000020</td><td class="cont" width="90%">FILE_ATTRIBUTE_ARCHIVE. The file or folder is an archive file. Applications use this attribute to mark files for backup or removal.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000080</td><td class="cont" width="90%">FILE_ATTRIBUTE_NORMAL. The file or folder has no other attributes set. This attribute is valid only if used alone.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000100</td><td class="cont" width="90%">FILE_ATTRIBUTE_TEMPORARY. The file is being used for temporary storage. File systems avoid writing data back to mass storage if sufficient cache memory is available, because often the application deletes the temporary file shortly after the handle is closed. In that case, the system can entirely avoid writing the data. Otherwise, the data will be written after the handle is closed.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000200</td><td class="cont" width="90%">FILE_ATTRIBUTE_SPARSE_FILE. The file is a sparse file.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000400</td><td class="cont" width="90%">FILE_ATTRIBUTE_REPARSE_POINT. The file or folder has an associated reparse point.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000800</td><td class="cont" width="90%">FILE_ATTRIBUTE_COMPRESSED. The file or folder is compressed. For a file, this means that all of the data in the file is compressed. For a folder, this means that compression is the default for newly created files and subdirectories.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00001000</td><td class="cont" width="90%">FILE_ATTRIBUTE_OFFLINE. The data of the file is not immediately available. This attribute indicates that the file data has been physically moved to offline storage. This attribute is used by Remote Storage, the hierarchical storage management software. Applications should not arbitrarily change this attribute.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00002000</td><td class="cont" width="90%">FILE_ATTRIBUTE_NOT_CONTENT_INDEXED. The file or directory is not be indexed by the content indexing service.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00004000</td><td class="cont" width="90%">FILE_ATTRIBUTE_ENCRYPTED. The file or folder is encrypted. For a file, this means that all data in the file is encrypted. For a folder, this means that encryption is the default for newly created files and subdirectories.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00010000</td><td class="cont" width="90%">FILE_ATTRIBUTE_VIRTUAL. A file is a virtual file.</td></tr>
       </table>
       if file system object does not exist this function returns -1.<br>
       Usage of the '*' and '?' mask symbols is allowed in the <em>S</em> argument. In that case the function
       checks only the first occurrence of the file or folder.<br>
       This function works only with the panels.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="panelitem">panelitem</a></dfn>(panelType,itemIndex,propIndex)</td>
    <td class="cont" width="60%">Queries the information for the panel element <em>itemIndex</em> from the
    active (<em>panelType</em>=0) or passive (<em>panelType</em>=1) panel. <em>propIndex</em> can be one
    of the following values:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Value</th><th class="cont" width="10%">Type</th><th class="cont" width="80%">Description</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">String</td><td class="cont" width="80%">File or folder name</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="10%">String</td><td class="cont" width="80%">File or folder short name</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">File attributes</td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Creation date/time</td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Last access date/time</td></tr>
        <tr class="cont"><td class="cont" width="10%">5</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Last modification date/time</td></tr>
        <tr class="cont"><td class="cont" width="10%">6</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Size</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Packed size</td></tr>
        <tr class="cont"><td class="cont" width="10%">8</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">"Is selected?"</td></tr>
        <tr class="cont"><td class="cont" width="10%">9</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Number of the hardlinks</td></tr>
        <tr class="cont"><td class="cont" width="10%">10</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">SortGroup</td></tr>
        <tr class="cont"><td class="cont" width="10%">11</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Diz-text</td></tr>
        <tr class="cont"><td class="cont" width="10%">12</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Owner</td></tr>
        <tr class="cont"><td class="cont" width="10%">13</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">CRC32</td></tr>
        <tr class="cont"><td class="cont" width="10%">14</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Position of the element while reading from the file system</td></tr>
       </table>
    Date/time is returned in the DD.MM.YYYY HH:MM:SS format.
    The values order and the delimiters are determined according to the regional settings.
    To receive information on the current file (under cursor) <em>itemIndex</em> should be set to 0.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="panel.setpos">panel.setpos</a></dfn>(panelType,fileName)</td>
    <td class="cont" width="60%">Positions the cursor on the element with name <em>fileName</em> on the active
      (<em>panelType</em>=0) or passive (<em>panelType</em>=1) panel.<br>
      Returns the position of the element or 0 if there is no such element.<br>
      For example, the following macro creates a directory named after the current date in
      YYYYMMDD format or positions the cursor on this directory if it already exists.
      <pre class=code>%dt=date("%Y%m0%d");
$If (fexist(%dt))
  panel.SetPos(0,%dt)
$Else
  F7 $Text %dt Enter
$End</pre>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="panel.setpath">panel.setpath</a></dfn>(panelType,pathName[,fileName])</td>
    <td class="cont" width="60%">Ќа активной (<em>panelType</em>=0) или пассивной (<em>panelType</em>=1) панели выставл€ет каталог <em>pathName</em> и
      позиционирует курсор на элемент с именем <em>fileName</em> (если указан параметр <em>fileName</em>).<br>
      ¬озвращает 1 в случае успешной установки каталога и 0, если каталог не существует.<br>
      Ќапример, на активной панели выставить каталог "C:\WINDOWS", на пассивной - "C:\Program Files", активную панель сделать слева и установить курсор на каталог "FAR":
      <pre class=code>$if(APanel.Left) CtrlU $End
panel.SetPath(1,"C:\\WINDOWS")
panel.SetPath(0,"C:\\Program Files","FAR")</pre>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="panel.setposidx">panel.setposidx</a></dfn>(panelType,indexItem)</td>
    <td class="cont" width="60%">Positions the cursor on the element with index <em>indexItem</em> on the active (<em>panelType</em>=0) or the passive (<em>panelType</em>=1) panel.<br>
      Returns element position or 0 if such element does not exist.<br>
    </td>
  </tr>

  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Control functions</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Function</th>
    <th class="cont" width="60%">Description</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="iif">iif</a></dfn>(Cond,True,False)</td>
    <td class="cont" width="60%">Conditional function. If condition <em>Cond</em> is true
    then <em>True</em>-expression is returned, <em>False</em>-expression otherwise.</td>
  </tr>

  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Execution environment</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Function</th>
    <th class="cont" width="60%">Description</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="akey">akey</a></dfn>(N)</td>
    <td class="cont" width="60%">Returns the name or code of the key combination that was used to call this macro.
      <em>N</em> = 0 - key code is returned, <em>N</em> = 1 - key name is returned.<br>
      See example in the full description <a href="akey.html">$AKey</a></td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="env">env</a></dfn>(V)</td>
    <td class="cont" width="60%">Returns the value of an environment variable V, for instance:<br>
    <pre class=code>$if (Env(&quot;FARLANG&quot;) == &quot;English&quot;) <em>...do something...</em> $end</pre></td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">B=<dfn><a name="msave">msave</a></dfn>(S)</td>
    <td class="cont" width="60%">Stores the value of a global variable with the name <em>S</em>
    to the <dfn>Vars</dfn> area.
    Returns 0 in case of failure.<br>
    Example: <pre class=code>%%GlobalVars="Foo Bar"; %a=msave("%%GlobalVars");</pre>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="clip">clip</a></dfn>(Cmd[,S])</td>
    <td class="cont" width="60%">Allows to perform miscellaneous manipulations on the Clipboard in accordance with the
         <em>Cmd</em> command:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Cmd</th><th class="cont" width="90%">Description</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">Returns data from the Clipboard; the <em>S</em> parameter is ignored; in case of error returns 0</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">Put the string <em>S</em> to the Clipboard; in case of error returns 0</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">Add the string <em>S</em> to the Clipboard; in case of error returns 0</td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="90%">Copy the Windows Clipboard to the internal clipboard buffer; the <em>S</em> parameter is ignored; in case of error returns 0</td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="90%">Copy the internal clipboard buffer to the Windows Clipboard; the <em>S</em> parameter is ignored; in case of error returns 0</td></tr>
       </table>
       For example, put to the Clipboard a list of selected files in the CSV format (name and size):
       <pre class=code>Clip(1,"Name;Size\r\n")
Home
$While(!APanel.Eof)
  $If(!APanel.Folder &amp;&amp; PanelItem(0,0,8))
     Clip(2,PanelItem(0,0,0)+";"+PanelItem(0,0,6)+"\r\n")
  $End
  Down
$End</pre>
       See <a href="iclip.html">$IClip</a>, <a href="boolstate.html#iclip">IClip</a>.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="flock">flock</a></dfn>(Nkey,NState)</td>
    <td class="cont" width="60%">ѕозвол€ет переключить состо€ние Lock-клавиш (NumLock, CapsLock и ScrollLock).<br>
     лавиша <em>Nkey</em>:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Nkey</th><th class="cont" width="90%">Description</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">NumLock</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">CapsLock</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">ScrollLock</td></tr>
       </table>
    —осто€ние <em>NState</em>:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">NState</th><th class="cont" width="90%">Description</th></tr>
        <tr class="cont"><td class="cont" width="10%">-1</td><td class="cont" width="90%">получить состо€ние клавиши</td></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">погасить индикатор</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">включить индикатор</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">переключить индикатор в противоположное состо€ние</td></tr>
       </table>
    ¬ Windows 95/98/Me функци€ может измен€ть только состо€ние клавиш CapsLock и ScrollLock. ƒл€ линейки NT (NT/2000/XP/...) этого ограничени€ нет.<br>
    ‘ункци€ капризна€ (возможно зависание компьютера), поэтому пользоватьс€ ей надо осторожно. Ќапример, макрос, повешенный на CtrlCapsLock (переключение между окнами) должен иметь некую обв€зку:
       <pre class=code>CtrlShiftTab
%a=flock(1,-1)&1;
$while((flock(1,-1)&1)==%a)
  sleep(50)
  flock(1,2)
$end</pre>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="sleep">sleep</a></dfn>(N)</td>
    <td class="cont" width="60%">Pause macro execution for <em>N</em> milliseconds.
     Negative sleep time is considered and error and the function returns 0.<br>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="waitkey">waitkey</a></dfn>([N, [T]])</td>
    <td class="cont" width="60%">ќжидает любую клавишу и возвращает ее название (<em>T</em>=0) или значение (<em>T</em>=1).
     ≈сли врем€ ожидани€ <em>N</em> (миллисекунды) истекло, функци€ возвращает пустую строку (<em>T</em>=0) или 0 (<em>T</em>=1).
     ≈сли параметр <em>N</em> не указан или равен 0, то функци€ будет бесконечно ждать нажати€ клавиши.
     <br>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="key">key</a></dfn>(V)</td>
    <td class="cont" width="60%">ѕреобразует параметр <em>V</em> в строковый эквивалент названи€ клавиши.<br>
     ≈сли <em>V</em> строка, то провер€етс€ правильность написани€ клавиши и она же возвращаетс€,
     если <em>V</em> число, то происходит попытка преобразовать значение в текстовый эквивалент названи€ клавиши.<br>
     ¬ случае ошибок - возвращаетс€ пуста€ строка.
     <br>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="eval">eval</a></dfn>(S)</td>
    <td class="cont" width="60%">"Play" the macro-sequence <em>S</em>.
      If <em>S</em> contains syntax errors, the sequence will not be played.
     <br>
     FAR compiles the sequence <em>S</em>. If there were no errors then the state of the current macro is saved and the sequence
     <em>S</em> is executed. When <em>S</em> finishes the interrupted macro continues.
     <p>The function returns 0 when <em>S</em> is successfully compiled.
     <p>Local variables are common for both the current macro and the macro executed by <dfn>eval</dfn>.

     <p>For example, we want by pressing F10 to open an Explorer window with the current folder on the active panel, command line contents should be saved.<br>
     We set 2 string variables, in the Vars area, containing a macro-sequence for saving and restoring the command line:
<pre class=code>
%%CmdSave=$If (!CmdLine.Empty) %Flg_Cmd=1;
          %CmdCurPos=CmdLine.ItemCount-CmdLine.CurPos+1;
          %CmdVal=CmdLine.Value; Esc $End

%%CmdRestore=$If (%Flg_Cmd==1) $Text %CmdVal
          %Flg_Cmd=0; %Num=%CmdCurPos;
          $While (%Num!=0) %Num=%Num-1; CtrlS $End $End
</pre>
     then we set the following macro to F10:
<pre class=code>
$If (APanel.Visible &amp;&amp; (!APanel.Plugin || (!APanel.Bof &amp;&amp;(APanel.OPIFlags &amp; 0x20))))
  Eval(%%CmdSave)
  $If (APanel.Current == "..")
    .
    ShiftEnter
  $Else
    "%SystemRoot%\\explorer.exe /select,"
    $If (Apanel.LFN)
      CtrlN
    $End
    CtrlEnter
    $If (!Apanel.LFN)
      CtrlN
    $End
    Enter
  $End
  Eval(%%CmdRestore)
$End
</pre>
    </td>
  </tr>


  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>User interaction</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Function</th>
    <th class="cont" width="60%">Description</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="msgbox">msgbox</a></dfn>([Title[,Text[,Flags]]])</td>
    <td class="cont" width="60%">Shows up the message box with the <em>Text</em> and the <em>Title</em>.
    Lines in the <em>Text</em> argument should be delimited by '\n'.<br>
      <em>Flags</em> can be a combination of the following values:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Flags</th><th class="cont" width="90%">Description</th></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000001</td><td class="cont" width="90%">Use the 'Warning' color scheme (usually white text on red background).</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000008</td><td class="cont" width="90%">Show the message lower by two lines.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00000010</td><td class="cont" width="90%">Use the left alignment for the message strings (align to center of not specified).</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00010000</td><td class="cont" width="90%">Show the &lt;Ok&gt; button.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00020000</td><td class="cont" width="90%">Show the &lt;Ok&gt; and &lt;Cancel&gt; buttons.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00030000</td><td class="cont" width="90%">Show the &lt;Abort&gt;, &lt;Retry&gt; and &lt;Ignore&gt; buttons.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00040000</td><td class="cont" width="90%">Show the &lt;Yes&gt; and &lt;No&gt; buttons.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00050000</td><td class="cont" width="90%">Show the &lt;Yes&gt;, &lt;No&gt; and &lt;Cancel&gt; buttons.</td></tr>
        <tr class="cont"><td class="cont" width="10%">0x00060000</td><td class="cont" width="90%">Show the &lt;Retry&gt; and &lt;Cancel&gt; buttons.</td></tr>
       </table>
    If the <em>Flags</em> argument is 0 (or omitted) then standard message box is displayed with the &lt;Ok&gt; button.<br>
    The return value is the number of the button the user selected (1 for the first, 2 for the second, etc.),
    if user canceled the message the result will be 0.
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="prompt">prompt</a></dfn>("Title"[,"Prompt"[,flags[, "Src"[, "History"]]]])</td>
    <td class="cont" width="60%">‘ункци€ позвол€ет ввести одну строку текста.<br>
      ѕараметры: <em>Title</em> - заголовок диалога, <em>Prompt</em> - приглашени€ дл€ ввода, <em>Src</em> - начальное значение строки ввода, <em>History</em> - им€ истории ввода<br>
      <em>Flags</em> может быть набором следующих значений (аналогичным константам <a href="../../service_functions/inputbox.html#INPUTBOXFLAGS">FIB_*</a>):
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Flag</th><th class="cont" width="90%">Description</th></tr>
           <tr class="cont"><td class="cont" width="40%">0x00000001</td><td class="cont" width="60%">даже если строка ввода пуста функци€ вернет значение пустое значение.</td></tr>
           <tr class="cont"><td class="cont" width="40%">0x00000002</td><td class="cont" width="60%">используетс€ дл€ ввода парол€ - вводимый текст на экране отрисовываетс€ символами <code>'*'</code>.</td></tr>
           <tr class="cont"><td class="cont" width="40%">0x00000004</td><td class="cont" width="60%">после успешного ввода, в результирующем значении <em>S</em> идентификаторы переменных окружени€ замен€ютс€ на их значени€, например, если пользователь ввел '<code>%TEMP%</code>', то <dfn>DestText</dfn> будет содержать '<code>C:\TEMP</code>'.</td></tr>
           <tr class="cont"><td class="cont" width="40%">0x00000008</td><td class="cont" width="60%">не использовать предыдущее значение из истории, оставить строку ввода пустой; актуален, если указан непустой параметр <em>History</em>.</td></tr>
           <tr class="cont"><td class="cont" width="40%">0x00000010</td><td class="cont" width="60%">показать разделительную линию и кнопки [Ok] и [Cancel]. ƒиалог увеличитс€ на 2 строки.</td></tr>
           <tr class="cont"><td class="cont" width="40%">0x00000020</td><td class="cont" width="60%">не показывать в приглашении ввода амперсанд, использовать его дл€ определени€ гор€чей клавиши.</td></tr>
       </table>
       ‘ункци€ возвращает строку - введенное пользователем значение.<br>
       Ќапример, запросить пароль и вывести его
      <pre class=code>%s=prompt("Password","Input password:",0x02); $Text %s</pre>
    </td>
  </tr>

  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Control elements</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Function</th>
    <th class="cont" width="60%">Description</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="checkhotkey">checkhotkey</a></dfn>(S)</td>
    <td class="cont" width="60%">Returns 1 if there is a hot key <em>S</em> in a menu
    and the current 'object' is a menu, otherwise returns 0.
    <p>For example there's a hotkey '7' assigned to 'S&amp;R' plugin in the plugins menu (F11).
    The following macro command sequence for the internal file editor should call 'S&amp;R'
    plugin if there is a hot key assigned and the standard search dialog if not:
    <pre class=code>F11 $if (checkhotkey(&quot;7&quot;)) 7 1 $else Esc AltF7 $end</pre>
  </tr>

  <tr class="cont">
    <td class="cont" width="40%">S=<dfn><a name="gethotkey">gethotkey</a></dfn>(N)</td>
    <td class="cont" width="60%">Returns the hotkey <em>S</em> for item <em>N</em>, if the item has a hotkey
      and the current &quot;object&quot; is a menu. Otherwise 0 is returned.<br>
      <em>N</em> - item position beginning with 1 (0 - current item).
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="menu.select">Menu.Select</a></dfn>(S[,N])</td>
    <td class="cont" width="60%">¬ меню позиционирует курсор на первый пункт, содержащий подстроку <em>S</em>.
    ѕоиск подстроки ведетс€ в зависимости от указанного режима <em>N</em>:
       <table class="cont">
        <tr class="cont"><th class="cont" width="40%">Mode</th><th class="cont" width="60%">Description</th></tr>
        <tr class="cont"><td class="cont" width="40%">0</td><td class="cont" width="60%">полное совпадение</td></tr>
        <tr class="cont"><td class="cont" width="40%">1</td><td class="cont" width="60%">совпадение с началом строки</td></tr>
        <tr class="cont"><td class="cont" width="40%">2</td><td class="cont" width="60%">совпадение с концом строки</td></tr>
        <tr class="cont"><td class="cont" width="40%">3</td><td class="cont" width="60%">присутствие подстроки <em>S</em> в пункте меню</td></tr>
       </table>
    ѕоиск регистронезависим. ≈сли такого пункта нет, то ничего не делает.<br>
    ¬озвращает: -1=ошибка - функци€ вызвана не дл€ меню, 0=ошибка при позиционировании (нет пункта или пункт задисаблен), иначе - позицию пункта меню.
    <pre class=code>F11 $if(Menu.Select(&quot;Advanced compare&quot;,0) > 0) Enter $end</pre>
    ≈сли параметр <em>N</em> не указан, подразумеваетс€ полное совпадение.
  </td>
  </tr>

  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="Dlg.GetValue">Dlg.GetValue</a></dfn>(ID,Type)</td>
    <td class="cont" width="60%">Get misc. values of the current dialog.<br>
      <em>ID</em> - dialog element number (elements are numbered starting with 1; 0 - is the dialog windows itself).<br>
      <em>Type</em> - type of the value to get, depending on the type of the element. For the dialog windows itself (ID=0) the following values are allowed:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Type</th><th class="cont" width="10%">Var type</th><th class="cont" width="80%">Description</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Number of elements in the dialog</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">X1</td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Y1</td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">X2</td></tr>
        <tr class="cont"><td class="cont" width="10%">5</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Y2</td></tr>
        <tr class="cont"><td class="cont" width="10%">6</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">ID of the current element that has the <a href="../../dialogapi/keybfocus.html">keyboard focus</a></td></tr>
       </table>

       For dialog elements the following values are allowed:
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Type</th><th class="cont" width="10%">Var type</th><th class="cont" width="10%">Element</th><th class="cont" width="70%">Description</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">CheckBox</td><td class="cont" width="70%">State of the checkbox</td></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">RadioButtons</td><td class="cont" width="70%">State of the radio button</td></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">String</td><td class="cont" width="10%">ListBox</td><td class="cont" width="70%">Value of the current list item</td></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">String</td><td class="cont" width="10%">ComboBox</td><td class="cont" width="70%">Value of the current list item</td></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">String</td><td class="cont" width="10%">Other</td><td class="cont" width="70%">Textual value (the <a href="../../dialogapi/structures/fardialogitem.html">FarDialogItem.Data</a> field)</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">All</td><td class="cont" width="70%"><a href="../../dialogapi/controls/index.html">Element type</a></td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">All</td><td class="cont" width="70%">X1 relative to the dialog window</td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">All</td><td class="cont" width="70%">Y1 relative to the dialog window</td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">All</td><td class="cont" width="70%">X2 relative to the dialog window</td></tr>
        <tr class="cont"><td class="cont" width="10%">5</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">All</td><td class="cont" width="70%">Y2 relative to the dialog window</td></tr>
        <tr class="cont"><td class="cont" width="10%">6</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">All</td><td class="cont" width="70%">does the element has focus?</td></tr>

        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">CheckBox</td><td class="cont" width="70%">State of the checkbox</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">RadioButtons</td><td class="cont" width="70%">State of the radio button</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">String</td><td class="cont" width="10%">ListBox</td><td class="cont" width="70%">Current position in the list (first list item = 1)</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">String</td><td class="cont" width="10%">ComboBox</td><td class="cont" width="70%">Current position in the list (first list item = 1)</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">Other</td><td class="cont" width="70%">0</td></tr>

        <tr class="cont"><td class="cont" width="10%">8</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">All</td><td class="cont" width="70%"><a href="../../dialogapi/flags/index.html">Element flags</a></td></tr>
        <tr class="cont"><td class="cont" width="10%">9</td><td class="cont" width="10%">Number</td><td class="cont" width="10%">All</td><td class="cont" width="70%">A flag that specifies that the given dialog element is the "default element".</td></tr>

        <tr class="cont"><td class="cont" width="10%">10</td><td class="cont" width="10%">String</td><td class="cont" width="10%">Other</td><td class="cont" width="70%">Textual value (the  <a href="../../dialogapi/structures/fardialogitem.html">FarDialogItem.Data</a> field)</td></tr>
       </table>
       Returns -1 if <em>ID</em> is bigger than the number of elements in the dialog or the value of <em>Type</em> is not supported.<br>
    </td>
  </tr>

  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="Editor.Set">Editor.Set</a></dfn>(Idx,Var)</td>
    <td class="cont" width="60%">Change settings of the current editor instance.
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Index</th><th class="cont" width="10%">Var Type</th><th class="cont" width="80%">Description</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Tab size</td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Expand tabs</td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Persistent blocks</td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Del removes blocks</td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Autoindent</td></tr>
        <tr class="cont"><td class="cont" width="10%">5</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Autodetect character table</td></tr>
        <tr class="cont"><td class="cont" width="10%">6</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Create new files in WIN encoding</td></tr>
        <tr class="cont"><td class="cont" width="10%">7</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Cursor beyond end of line</td></tr>
        <tr class="cont"><td class="cont" width="10%">8</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">BackSpace behaviour (TechInfo #13)</td></tr>
        <tr class="cont"><td class="cont" width="10%">9</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Representation of the character under cursor in the status line (TechInfo #32)</td></tr>
        <tr class="cont"><td class="cont" width="10%">10</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Save file position</td></tr>
        <tr class="cont"><td class="cont" width="10%">11</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">Save bookmarks</td></tr>
        <tr class="cont"><td class="cont" width="10%">12</td><td class="cont" width="10%">String</td><td class="cont" width="80%">Word delimiters (TechInfo #1)</td></tr>
        <tr class="cont"><td class="cont" width="10%">13</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">EditorF7Rules (TechInfo #18)</td></tr>
        <tr class="cont"><td class="cont" width="10%">14</td><td class="cont" width="10%">Number</td><td class="cont" width="80%">AllowEmptySpaceAfterEof (TechInfo #67)</td></tr>
       </table>
       The value of <em>Var</em> can be  -1, in this case the function will not change any settings
       and will return the current state of the option.<br>
       Returns the previous value of the option or -1 if wrong arguments are given.<br>
       For example, a macro that moves the selected block one line down:
       <pre class=code>$IClip CtrlX %a=Editor.Set(2,1); Down CtrlV %a=Editor.Set(2,%a);</pre>
    </td>
  </tr>


  <tr class="cont">
    <td class="cont" width="40%">V=<dfn><a name="editor.sel">Editor.Sel</a></dfn>(Action[,Opt])</td>
    <td class="cont" width="60%">‘ункци€ позвол€ет производить некоторые операции с блоками в тексте (в редакторе, в строках ввода в диалогах, в командной строке).
       <table class="cont">
       <tr class="cont"><th class="cont" width="10%">Action</th><th class="cont" width="90%">ќписание</th></tr>
        <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">получить параметры текущего блока
        <table class="cont">
          <tr class="cont"><th class="cont" width="10%">Opt</th><th class="cont" width="90%">ќписание</th></tr>
          <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">вернуть номер строки начала блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">вернуть номер позиции в строке начала блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">вернуть номер строки конца блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="90%">вернуть номер позиции в строке конца блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="90%">вернуть тип выделенного блока: 0 - блок не выделен, 1 - обычный блок, 2 - вертикальный блок
            (альтернативный вариант - <a href="states.html#editor.state">Editor.State</a>)</td></tr>
        </table>
        </td></tr>
        <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">позиционировать курсор внутри текущего блока (при позиционировании курсора состо€ние блока не измен€етс€)
        <table class="cont">
          <tr class="cont"><th class="cont" width="10%">Opt</th><th class="cont" width="90%">ќписание</th></tr>
          <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">установить курсор в начало отмеченного блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">установить курсор в конец отмеченного блока</td></tr>
        </table>
        </td></tr>
        <tr class="cont"><td class="cont" width="10%">2</td><td class="cont" width="90%">установка позиций блока
        <table class="cont">
          <tr class="cont"><th class="cont" width="10%">Opt</th><th class="cont" width="90%">ќписание</th></tr>
          <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">отметить позицию начала блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">отметить позицию конца блока</td></tr>
        </table>
        ѕозицией начала/конца блока считаетс€ текуща€ позици€ курсора. Ѕлок помечаетс€ только после указани€ конечной позиции (<em>Opt</em>=1), с ранее выделенного блока пометка снимаетс€.
        ≈сли позици€ начала и конца блока совпадают, то эта операци€ равносильна сн€тию пометки блока.
        </td></tr>
        <tr class="cont"><td class="cont" width="10%">3</td><td class="cont" width="90%">установка позиций вертикального блока
        <table class="cont">
          <tr class="cont"><th class="cont" width="10%">Opt</th><th class="cont" width="90%">ќписание</th></tr>
          <tr class="cont"><td class="cont" width="10%">0</td><td class="cont" width="90%">отметить позицию начала вертикального блока</td></tr>
          <tr class="cont"><td class="cont" width="10%">1</td><td class="cont" width="90%">отметить позицию конца вертикального блока</td></tr>
        </table>
        ѕозицией начала/конца блока считаетс€ текуща€ позици€ курсора. Ѕлок помечаетс€ только после указани€ конечной позиции (<em>Opt</em>=1), с ранее выделенного блока пометка снимаетс€.
        ≈сли позици€ начала и конца блока совпадают, то эта операци€ равносильна сн€тию пометки блока.
        </td></tr>
        <tr class="cont"><td class="cont" width="10%">4</td><td class="cont" width="90%">сн€ть выделение с блока<br>
        ѕараметр <em>Opt</em> игнорируетс€.<br>
        ¬сегда возвращаетс€ 1.
        </td></tr>
       </table>
       ¬ случае ошибки (в т.ч. функци€ вызвана не из "редактора") возвращаемое значение равно 0, иначе 1. ƒл€ <em>Action</em>=0 возвращаетс€ запрошенное значение.
      <br>
      Ќапример, повторим некоторые сочетани€ клавиш из Turbo-сред (макрос на сочетание Ctrl-K):
      <pre class=code>%k=waitkey(0,1);
$if(%k==B || %k==b || %k==CtrlB)
  editor.sel(2,0)
$else
  $if(%k==K || %k==k || %k==CtrlK)
    editor.sel(2,1)
  $else
    $if((%k==C || %k==c || %k==CtrlC) &amp;&amp; Selected)
      CtrlC
    $else
      $if((%k==Y || %k==y || %k==CtrlY) &amp;&amp; Selected)
        CtrlD
      $else
        eval("F1")
      $end
    $end
  $end
$end</pre>
    </td>
  </tr>

  <!-- -------------------------------------- -->
  <tr class="cont"><th class="cont" colspan=2>Bookmarks</th></tr>
  <tr class="cont">
    <th class="cont" width="40%">Function</th>
    <th class="cont" width="60%">Description</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="BM.Add">BM.Add</a></dfn>()</td>
    <td class="cont" width="60%">ƒобавить текущие параметры закладки и обрезать хвост</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="BM.Clear">BM.Clear</a></dfn>()</td>
    <td class="cont" width="60%">ќчистить все закладки</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="BM.Del">BM.Del</a></dfn>([Idx])</td>
    <td class="cont" width="60%">”далить закладку с указанным индексом <em>Idx</em> (нумераци€ начинаетс€ с 1). ≈сли параметр <em>Idx</em> не указан или равен 0 - удал€етс€ текуща€ закладка.</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="BM.Get">BM.Get</a></dfn>(Idx,M)</td>
    <td class="cont" width="60%">ѕолучить параметры закладки с индексом <em>Idx</em> (нумераци€ начинаетс€ с 1), Idx=0 - текуща€ закладка.<br>
      ѕараметр <em>M</em> может быть одним из следующих:
       <table class="cont">
        <tr class="cont"><th class="cont" width="40%">“ип</th><th class="cont" width="60%">ќписание</th></tr>
        <tr class="cont"><td class="cont" width="40%">0</td><td class="cont" width="60%">координаты строки (начина€ с 1)</td></tr>
        <tr class="cont"><td class="cont" width="40%">1</td><td class="cont" width="60%">координаты колонки (начина€ с 1)</td></tr>
        <tr class="cont"><td class="cont" width="40%">2</td><td class="cont" width="60%">позици€, соответствующа€ первому видимому символу текста на экране слева</td></tr>
        <tr class="cont"><td class="cont" width="40%">3</td><td class="cont" width="60%">номер строки, соответствующей первой видимой строке текста на экране</td></tr>
       </table>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="BM.Next">BM.Next</a></dfn>()</td>
    <td class="cont" width="60%">ѕерейти на следующую закладку</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="BM.Prev">BM.Prev</a></dfn>()</td>
    <td class="cont" width="60%">ѕерейти на предыдущую закладку</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="40%">N=<dfn><a name="BM.Stat">BM.Stat</a></dfn>([M])</td>
    <td class="cont" width="60%">ѕолучить информацию о закладках.<br>
      ѕараметр <em>M</em> может быть одним из следующих:
       <table class="cont">
        <tr class="cont"><th class="cont" width="40%">“ип</th><th class="cont" width="60%">ќписание</th></tr>
        <tr class="cont"><td class="cont" width="40%">0</td><td class="cont" width="60%">текущее количество закладок</td></tr>
       </table>
    </td>
  </tr>
  <tr class="cont"><td class="cont" colspan=2>ѕример работы с закладками:<pre class=code>

  </pre></td></tr>

  </table>

<h3>Notes</h3>
<div class=descr>
<ol>
<li>‘ункции работы с закладками BM.XXX() доступны только в редакторе.
<li>Function arguments given in square brackets may be omitted. See default values in function description.
<li>It is impossible to use macro-language elements while <a href="../macrokey/record.html">recording</a>
  a macro in a usual way. Macro-language elements can be added to the sequence only by editing
  the registry manually or by using special applications or FAR plugins.</li>
</ol>
</div>


</body>

</html>
